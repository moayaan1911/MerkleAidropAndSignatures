<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merkle Airdrop & Signature Verification - Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 50px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .section h3 {
            color: #764ba2;
            font-size: 1.5rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        .diagram-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .diagram-container svg {
            max-width: 100%;
            height: auto;
        }

        .concept-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            position: relative;
        }

        .code-block .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .code-block .copy-btn:hover {
            background: #764ba2;
        }

        .code-block pre {
            margin: 0;
        }

        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }
        .variable { color: #9cdcfe; }
        .type { color: #4ec9b0; }

        .flow-step {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
        }

        .flow-step::before {
            content: '‚Üí';
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            color: #667eea;
        }

        .flow-step:first-child::before {
            display: none;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin: 20px 0;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            border-bottom: 2px solid transparent;
            margin-right: 5px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            border-bottom: 2px solid #667eea;
            color: #667eea;
        }

        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }

        .info-card {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .warning-card {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .success-card {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .nav-menu {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .nav-menu ul {
            list-style: none;
        }

        .nav-menu li {
            margin: 10px 0;
        }

        .nav-menu a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .nav-menu a:hover {
            color: #764ba2;
        }

        .highlight {
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            padding: 2px 6px;
            border-radius: 3px;
        }

        .merkle-tree {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .merkle-level {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .merkle-node {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .merkle-leaf {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .merkle-root {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            font-weight: bold;
        }

        .arrow {
            font-size: 2rem;
            color: #667eea;
        }

        .workflow-diagram {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        .workflow-step {
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            width: 300px;
            text-align: center;
            position: relative;
        }

        .workflow-step::after {
            content: '‚Üì';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            color: #667eea;
        }

        .workflow-step:last-child::after {
            display: none;
        }

        .interactive-demo {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .demo-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .demo-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .demo-btn:hover {
            background: #764ba2;
        }

        .demo-output {
            background: white;
            padding: 15px;
            border-radius: 5px;
            min-height: 100px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .header h1 {
                font-size: 2rem;
            }

            .section {
                padding: 20px;
            }
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
        }

        tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="nav-menu">
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#concepts">Core Concepts</a></li>
            <li><a href="#contracts">Contracts</a></li>
            <li><a href="#scripts">Scripts</a></li>
            <li><a href="#tests">Tests</a></li>
            <li><a href="#workflow">Workflow</a></li>
        </ul>
    </div>

    <div class="container">
        <div class="header">
            <h1>ü•Ø Merkle Airdrop & Signature Verification</h1>
            <p>A Complete Guide to Gas-Efficient Token Distribution</p>
        </div>

        <!-- Section 1: Project Overview -->
        <div class="section" id="overview">
            <h2>üìã Project Overview</h2>
            
            <div class="concept-box">
                <h3>What is this project?</h3>
                <p>This project implements a <span class="highlight">secure, gas-efficient token airdrop system</span> that combines two powerful cryptographic techniques:</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>Merkle Trees</strong> - For off-chain whitelist verification</li>
                    <li><strong>EIP-712 Signatures</strong> - For secure, replay-attack-proof claiming</li>
                </ul>
            </div>

            <h3>üéØ Key Features</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>Description</th>
                            <th>Benefit</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>üå≥ Merkle Trees</td>
                            <td>Store whitelist off-chain</td>
                            <td>Massive gas savings (no on-chain storage)</td>
                        </tr>
                        <tr>
                            <td>‚úçÔ∏è EIP-712 Signatures</td>
                            <td>Typed data signatures</td>
                            <td>Prevents replay attacks, user authorization</td>
                        </tr>
                        <tr>
                            <td>‚õΩ Gas Optimization</td>
                            <td>calldata instead of memory</td>
                            <td>Lower gas costs for claims</td>
                        </tr>
                        <tr>
                            <td>üîí Security</td>
                            <td>Double hashing</td>
                            <td>Prevents preimage attacks</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>üìÅ Project Structure</h3>
            <div class="diagram-container">
                <svg width="600" height="400" viewBox="0 0 600 400">
                    <!-- Root -->
                    <rect x="250" y="10" width="100" height="40" fill="#667eea" rx="5"/>
                    <text x="300" y="35" text-anchor="middle" fill="white" font-size="12">Project Root</text>
                    
                    <!-- src -->
                    <rect x="100" y="80" width="120" height="60" fill="#764ba2" rx="5"/>
                    <text x="160" y="105" text-anchor="middle" fill="white" font-size="12">src/</text>
                    <text x="160" y="125" text-anchor="middle" fill="white" font-size="10">Contracts</text>
                    
                    <!-- script -->
                    <rect x="240" y="80" width="120" height="60" fill="#f093fb" rx="5"/>
                    <text x="300" y="105" text-anchor="middle" fill="white" font-size="12">script/</text>
                    <text x="300" y="125" text-anchor="middle" fill="white" font-size="10">Deployment & Utils</text>
                    
                    <!-- test -->
                    <rect x="380" y="80" width="120" height="60" fill="#4facfe" rx="5"/>
                    <text x="440" y="105" text-anchor="middle" fill="white" font-size="12">test/</text>
                    <text x="440" y="125" text-anchor="middle" fill="white" font-size="10">Test Suite</text>
                    
                    <!-- Contract files -->
                    <rect x="50" y="170" width="100" height="35" fill="#e0e0e0" rx="3"/>
                    <text x="100" y="192" text-anchor="middle" fill="#333" font-size="10">BagelToken.sol</text>
                    
                    <rect x="160" y="170" width="100" height="35" fill="#e0e0e0" rx="3"/>
                    <text x="210" y="192" text-anchor="middle" fill="#333" font-size="10">MerkelAirdrop.sol</text>
                    
                    <!-- Script files -->
                    <rect x="270" y="170" width="100" height="25" fill="#e0e0e0" rx="3"/>
                    <text x="320" y="186" text-anchor="middle" fill="#333" font-size="9">Deploy.s.sol</text>
                    
                    <rect x="270" y="200" width="100" height="25" fill="#e0e0e0" rx="3"/>
                    <text x="320" y="216" text-anchor="middle" fill="#333" font-size="9">GenerateInput.s.sol</text>
                    
                    <rect x="270" y="230" width="100" height="25" fill="#e0e0e0" rx="3"/>
                    <text x="320" y="246" text-anchor="middle" fill="#333" font-size="9">MakeMerkel.s.sol</text>
                    
                    <rect x="270" y="260" width="100" height="25" fill="#e0e0e0" rx="3"/>
                    <text x="320" y="276" text-anchor="middle" fill="#333" font-size="9">Interact.s.sol</text>
                    
                    <!-- Test file -->
                    <rect x="400" y="170" width="100" height="35" fill="#e0e0e0" rx="3"/>
                    <text x="450" y="192" text-anchor="middle" fill="#333" font-size="10">MerkelAirdrop.t.sol</text>
                    
                    <!-- Lines -->
                    <line x1="300" y1="50" x2="160" y2="80" stroke="#667eea" stroke-width="2"/>
                    <line x1="300" y1="50" x2="300" y2="80" stroke="#667eea" stroke-width="2"/>
                    <line x1="300" y1="50" x2="440" y2="80" stroke="#667eea" stroke-width="2"/>
                    
                    <line x1="160" y1="140" x2="100" y2="170" stroke="#764ba2" stroke-width="2"/>
                    <line x1="160" y1="140" x2="210" y2="170" stroke="#764ba2" stroke-width="2"/>
                    
                    <line x1="300" y1="140" x2="320" y2="170" stroke="#f093fb" stroke-width="2"/>
                    <line x1="300" y1="140" x2="320" y2="200" stroke="#f093fb" stroke-width="2"/>
                    <line x1="300" y1="140" x2="320" y2="230" stroke="#f093fb" stroke-width="2"/>
                    <line x1="300" y1="140" x2="320" y2="260" stroke="#f093fb" stroke-width="2"/>
                    
                    <line x1="440" y1="140" x2="450" y2="170" stroke="#4facfe" stroke-width="2"/>
                </svg>
            </div>
        </div>

        <!-- Section 2: Core Concepts -->
        <div class="section" id="concepts">
            <h2>üß† Core Concepts</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('merkle')">Merkle Trees</button>
                <button class="tab" onclick="showTab('eip712')">EIP-712 Signatures</button>
                <button class="tab" onclick="showTab('gas')">Gas Optimization</button>
            </div>

            <div id="merkle" class="tab-content active">
                <h3>üå≥ Understanding Merkle Trees</h3>
                
                <div class="concept-box">
                    <h4>What is a Merkle Tree?</h4>
                    <p>A <strong>Merkle Tree</strong> (or binary hash tree) is a data structure that allows efficient verification of large datasets. In this project, it enables storing thousands of whitelist addresses off-chain while only keeping a single 32-byte hash (the <strong>Merkle Root</strong>) on-chain.</p>
                </div>

                <h4>How It Works:</h4>
                <ol style="margin-left: 20px; line-height: 2;">
                    <li><strong>Leaf Creation:</strong> Each (address, amount) pair is hashed to create a leaf</li>
                    <li><strong>Pair Hashing:</strong> Leaves are paired and hashed together</li>
                    <li><strong>Tree Building:</strong> Process continues until a single root hash remains</li>
                    <li><strong>Verification:</strong> To verify a claim, only need the leaf + Merkle Proof (sibling hashes)</li>
                </ol>

                <div class="diagram-container">
                    <svg width="700" height="400" viewBox="0 0 700 400">
                        <!-- Title -->
                        <text x="350" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#667eea">Merkle Tree Structure</text>
                        
                        <!-- Root -->
                        <rect x="300" y="50" width="100" height="40" fill="#4facfe" rx="5"/>
                        <text x="350" y="75" text-anchor="middle" fill="white" font-size="11">Merkle Root</text>
                        
                        <!-- Level 2 -->
                        <rect x="150" y="120" width="100" height="35" fill="#667eea" rx="5"/>
                        <text x="200" y="142" text-anchor="middle" fill="white" font-size="10">Hash(A+B)</text>
                        
                        <rect x="450" y="120" width="100" height="35" fill="#667eea" rx="5"/>
                        <text x="500" y="142" text-anchor="middle" fill="white" font-size="10">Hash(C+D)</text>
                        
                        <!-- Level 3 -->
                        <rect x="50" y="190" width="80" height="30" fill="#764ba2" rx="5"/>
                        <text x="90" y="210" text-anchor="middle" fill="white" font-size="9">Hash A</text>
                        
                        <rect x="150" y="190" width="80" height="30" fill="#764ba2" rx="5"/>
                        <text x="190" y="210" text-anchor="middle" fill="white" font-size="9">Hash B</text>
                        
                        <rect x="470" y="190" width="80" height="30" fill="#764ba2" rx="5"/>
                        <text x="510" y="210" text-anchor="middle" fill="white" font-size="9">Hash C</text>
                        
                        <rect x="570" y="190" width="80" height="30" fill="#764ba2" rx="5"/>
                        <text x="610" y="210" text-anchor="middle" fill="white" font-size="9">Hash D</text>
                        
                        <!-- Leaves -->
                        <rect x="30" y="260" width="120" height="35" fill="#f093fb" rx="5"/>
                        <text x="90" y="280" text-anchor="middle" fill="white" font-size="9">Leaf: (Addr1, Amt1)</text>
                        
                        <rect x="160" y="260" width="120" height="35" fill="#f093fb" rx="5"/>
                        <text x="220" y="280" text-anchor="middle" fill="white" font-size="9">Leaf: (Addr2, Amt2)</text>
                        
                        <rect x="450" y="260" width="120" height="35" fill="#f093fb" rx="5"/>
                        <text x="510" y="280" text-anchor="middle" fill="white" font-size="9">Leaf: (Addr3, Amt3)</text>
                        
                        <rect x="580" y="260" width="120" height="35" fill="#f093fb" rx="5"/>
                        <text x="640" y="280" text-anchor="middle" fill="white" font-size="9">Leaf: (Addr4, Amt4)</text>
                        
                        <!-- Arrows -->
                        <line x1="200" y1="155" x2="320" y2="90" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="500" y1="155" x2="380" y2="90" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
                        
                        <line x1="90" y1="220" x2="170" y2="155" stroke="#764ba2" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="190" y1="220" x2="210" y2="155" stroke="#764ba2" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="510" y1="220" x2="510" y2="155" stroke="#764ba2" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="610" y1="220" x2="530" y2="155" stroke="#764ba2" stroke-width="2" marker-end="url(#arrowhead)"/>
                        
                        <!-- Merkle Proof Highlight -->
                        <rect x="450" y="320" width="200" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                        <text x="550" y="345" text-anchor="middle" fill="#333" font-size="11">Merkle Proof for Leaf C:</text>
                        <text x="550" y="365" text-anchor="middle" fill="#333" font-size="10">[Hash D, Hash(A+B)]</text>
                        
                        <!-- Arrow marker -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="info-card">
                    <h4>üí° Why Merkle Trees for Airdrops?</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Gas Efficiency:</strong> Only store 32 bytes on-chain instead of thousands of addresses</li>
                        <li><strong>Privacy:</strong> Whitelist remains off-chain until claimed</li>
                        <li><strong>Flexibility:</strong> Easy to add/remove addresses by updating the root</li>
                        <li><strong>Verification:</strong> O(log n) verification time, very efficient</li>
                    </ul>
                </div>

                <h4>Leaf Hashing Process:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// Double hashing to prevent preimage attacks</span>
<span class="comment">// Step 1: Encode address and amount with type safety</span>
<span class="type">bytes</span> encoded = <span class="function">abi.encode</span>(_account, _amount);

<span class="comment">// Step 2: First hash</span>
<span class="type">bytes32</span> firstHash = <span class="function">keccak256</span>(encoded);

<span class="comment">// Step 3: Concatenate and hash again (prevents second-preimage attacks)</span>
<span class="type">bytes32</span> leaf = <span class="function">keccak256</span>(<span class="function">bytes.concat</span>(firstHash));</pre>
                </div>

                <div class="warning-card">
                    <h4>‚ö†Ô∏è Why Double Hashing?</h4>
                    <p>Double hashing prevents <strong>second-preimage attacks</strong> where an attacker could find a different input that produces the same hash. The second hash makes this computationally infeasible.</p>
                </div>
            </div>

            <div id="eip712" class="tab-content">
                <h3>‚úçÔ∏è EIP-712 Typed Data Signatures</h3>
                
                <div class="concept-box">
                    <h4>What is EIP-712?</h4>
                    <p><strong>EIP-712</strong> (Ethereum Improvement Proposal 712) is a standard for signing structured data. Unlike traditional message signing, EIP-712 provides:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Human-readable signatures</strong> - Users see what they're signing</li>
                        <li><strong>Typed data</strong> - Prevents ambiguity in data interpretation</li>
                        <li><strong>Domain separation</strong> - Signatures are contract-specific</li>
                        <li><strong>Replay protection</strong> - Chain ID and contract address included</li>
                    </ul>
                </div>

                <h4>EIP-712 Structure:</h4>
                <div class="diagram-container">
                    <svg width="700" height="350" viewBox="0 0 700 350">
                        <!-- Title -->
                        <text x="350" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#667eea">EIP-712 Typed Data Structure</text>
                        
                        <!-- Domain Separator -->
                        <rect x="50" y="60" width="280" height="120" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                        <text x="190" y="85" text-anchor="middle" font-weight="bold" fill="#2196f3">Domain Separator</text>
                        <text x="70" y="110" fill="#333" font-size="11">‚Ä¢ Name: "MerkelAirdrop"</text>
                        <text x="70" y="130" fill="#333" font-size="11">‚Ä¢ Version: "1"</text>
                        <text x="70" y="150" fill="#333" font-size="11">‚Ä¢ Chain ID: 31337</text>
                        <text x="70" y="170" fill="#333" font-size="11">‚Ä¢ Contract: 0x...</text>
                        
                        <!-- Message Data -->
                        <rect x="370" y="60" width="280" height="120" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                        <text x="510" y="85" text-anchor="middle" font-weight="bold" fill="#9c27b0">Message Data</text>
                        <text x="390" y="110" fill="#333" font-size="11">‚Ä¢ Type: AirdropClaim</text>
                        <text x="390" y="130" fill="#333" font-size="11">‚Ä¢ Account: 0x...</text>
                        <text x="390" y="150" fill="#333" font-size="11">‚Ä¢ Amount: 25 * 10^18</text>
                        <text x="390" y="170" fill="#333" font-size="11">‚Ä¢ TypeHash: 0x...</text>
                        
                        <!-- Hash Process -->
                        <rect x="50" y="210" width="600" height="80" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                        <text x="350" y="235" text-anchor="middle" font-weight="bold" fill="#ff9800">Typed Data Hash Calculation</text>
                        <text x="70" y="260" fill="#333" font-size="11">keccak256(</text>
                        <text x="90" y="280" fill="#333" font-size="11">  0x1901 || keccak256(Domain) || keccak256(Message)</text>
                        <text x="70" y="300" fill="#333" font-size="11">)</text>
                        
                        <!-- Signature -->
                        <rect x="200" y="310" width="300" height="30" fill="#4caf50" rx="5"/>
                        <text x="350" y="330" text-anchor="middle" fill="white" font-size="11">ECDSA Signature (v, r, s)</text>
                    </svg>
                </div>

                <h4>Signature Verification Flow:</h4>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <strong>1. User Signs</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Signs typed data with their private key</p>
                    </div>
                    <div class="workflow-step">
                        <strong>2. Extract Components</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Split signature into v, r, s</p>
                    </div>
                    <div class="workflow-step">
                        <strong>3. Recover Address</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Use ECDSA.recover to get signer</p>
                    </div>
                    <div class="workflow-step">
                        <strong>4. Verify Match</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Compare recovered address with claimer</p>
                    </div>
                </div>

                <h4>Code Implementation:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// EIP-712 Type Hash</span>
<span class="type">bytes32</span> <span class="keyword">private constant</span> AIRDROP_CLAIM_TYPEHASH = 
    <span class="function">keccak256</span>(<span class="string">"AirdropClaim(address account,uint256 amount)"</span>);

<span class="comment">// Struct for typed data</span>
<span class="keyword">struct</span> <span class="type">AirdropClaim</span> {
    <span class="type">address</span> account;
    <span class="type">uint256</span> amount;
}

<span class="comment">// Generate message hash</span>
<span class="keyword">function</span> <span class="function">getMessageHash</span>(<span class="type">address</span> _account, <span class="type">uint256</span> _amount) 
    <span class="keyword">public</span> <span class="keyword">view</span> <span class="keyword">returns</span> (<span class="type">bytes32</span>) 
{
    <span class="keyword">return</span> <span class="function">_hashTypedDataV4</span>(
        <span class="function">keccak256</span>(<span class="function">abi.encode</span>(
            AIRDROP_CLAIM_TYPEHASH,
            <span class="type">AirdropClaim</span>({account: _account, amount: _amount})
        ))
    );
}

<span class="comment">// Verify signature</span>
<span class="keyword">function</span> <span class="function">_isValidSignature</span>(
    <span class="type">address</span> _account,
    <span class="type">bytes32</span> _digest,
    <span class="type">uint8</span> _v,
    <span class="type">bytes32</span> _r,
    <span class="type">bytes32</span> _s
) <span class="keyword">internal pure returns</span> (<span class="type">bool</span>) {
    (<span class="type">address</span> actualSigner,,) = <span class="function">ECDSA.tryRecover</span>(_digest, _v, _r, _s);
    <span class="keyword">return</span> actualSigner == _account;
}</pre>
                </div>

                <div class="success-card">
                    <h4>‚úÖ Benefits of EIP-712</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>User Safety:</strong> Users see exactly what they're signing</li>
                        <li><strong>No Replay:</strong> Signature only valid for this contract on this chain</li>
                        <li><strong>Frontend Friendly:</strong> Easy to integrate with wallets</li>
                        <li><strong>Gasless Claims:</strong> Relayers can submit signed claims on behalf of users</li>
                    </ul>
                </div>
            </div>

            <div id="gas" class="tab-content">
                <h3>‚õΩ Gas Optimization Techniques</h3>
                
                <div class="concept-box">
                    <h4>Why Gas Optimization Matters</h4>
                    <p>Gas costs directly impact user experience and project viability. This project uses several techniques to minimize gas consumption.</p>
                </div>

                <h4>1. Calldata vs Memory</h4>
                <div class="info-card">
                    <p><strong>calldata</strong> is read-only data from transaction input, while <strong>memory</strong> is temporary storage that requires copying. Using calldata saves gas when data is only read.</p>
                </div>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// ‚ùå BAD: Uses memory (copies array, costs more gas)</span>
<span class="keyword">function</span> <span class="function">claimBad</span>(
    <span class="type">address</span> _account,
    <span class="type">uint256</span> _amount,
    <span class="type">bytes32[] memory</span> _merkleProof  <span class="comment">// Memory copy!</span>
) <span class="keyword">external</span> { ... }

<span class="comment">// ‚úÖ GOOD: Uses calldata (no copy, cheaper)</span>
<span class="keyword">function</span> <span class="function">claim</span>(
    <span class="type">address</span> _account,
    <span class="type">uint256</span> _amount,
    <span class="type">bytes32[] calldata</span> _merkleProof  <span class="comment">// Read-only!</span>
) <span class="keyword">external</span> { ... }</pre>
                </div>

                <h4>2. Immutable Variables</h4>
                <div class="info-card">
                    <p><strong>immutable</strong> variables are set once in the constructor and embedded directly in the bytecode, avoiding storage reads.</p>
                </div>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// ‚úÖ Uses immutable to avoid storage reads</span>
<span class="type">bytes32</span> <span class="keyword">private immutable</span> i_merkleRoot;
<span class="type">IERC20</span> <span class="keyword">private immutable</span> i_airdropToken;

<span class="keyword">constructor</span>(<span class="type">bytes32</span> _merkleRoot, <span class="type">IERC20</span> _airdropToken) {
    i_merkleRoot = _merkleRoot;  <span class="comment">// Set once, never changes</span>
    i_airdropToken = _airdropToken;
}</pre>
                </div>

                <h4>3. Event Logging</h4>
                <div class="info-card">
                    <p>Events are much cheaper than storage for recording data. Use them for tracking claims.</p>
                </div>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// ‚úÖ Event for tracking (cheap)</span>
<span class="keyword">event</span> <span class="function">AirdropClaimed</span>(<span class="type">address indexed</span> account, <span class="type">uint256</span> amount);

<span class="comment">// Emit when claim is successful</span>
<span class="function">emit AirdropClaimed</span>(_account, _amount);</pre>
                </div>

                <h4>Gas Cost Comparison:</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Operation</th>
                                <th>Memory</th>
                                <th>Calldata</th>
                                <th>Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Read 32 bytes</td>
                                <td>3 gas</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Write 32 bytes</td>
                                <td>20,000 gas</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Copy array (10 elements)</td>
                                <td>~2,000 gas</td>
                                <td>0 gas</td>
                                <td>~2,000 gas</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Section 3: Contracts -->
        <div class="section" id="contracts">
            <h2>üìù Smart Contracts</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('bagel')">BagelToken</button>
                <button class="tab" onclick="showTab('merkle')">MerkelAirdrop</button>
            </div>

            <div id="bagel" class="tab-content active">
                <h3>ü•Ø BagelToken Contract</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>A standard ERC20 token with minting capabilities, used as the airdrop token.</p>
                </div>

                <h4>Contract Overview:</h4>
                <div class="diagram-container">
                    <svg width="600" height="300" viewBox="0 0 600 300">
                        <rect x="50" y="50" width="500" height="200" fill="#f5f5f5" stroke="#667eea" stroke-width="2" rx="10"/>
                        <text x="300" y="80" text-anchor="middle" font-weight="bold" font-size="16" fill="#667eea">BagelToken Contract</text>
                        
                        <rect x="80" y="100" width="200" height="30" fill="#e3f2fd" rx="5"/>
                        <text x="180" y="120" text-anchor="middle" font-size="12">Inherits: ERC20, Ownable</text>
                        
                        <rect x="80" y="150" width="200" height="30" fill="#fff3e0" rx="5"/>
                        <text x="180" y="170" text-anchor="middle" font-size="12">Name: "BagelToken"</text>
                        
                        <rect x="80" y="200" width="200" height="30" fill="#f3e5f5" rx="5"/>
                        <text x="180" y="220" text-anchor="middle" font-size="12">Symbol: "BAGEL"</text>
                        
                        <rect x="320" y="120" width="200" height="80" fill="#e8f5e9" rx="5"/>
                        <text x="420" y="145" text-anchor="middle" font-weight="bold" fill="#4caf50">mint() Function</text>
                        <text x="420" y="165" text-anchor="middle" font-size="11">‚Ä¢ onlyOwner modifier</text>
                        <text x="420" y="180" text-anchor="middle" font-size="11">‚Ä¢ Creates new tokens</text>
                        <text x="420" y="195" text-anchor="middle" font-size="11">‚Ä¢ Transfers to recipient</text>
                    </svg>
                </div>

                <h4>Complete Code:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// SPDX-License-Identifier: MIT</span>
<span class="keyword">pragma</span> solidity ^0.8.24;

<span class="keyword">import</span> {ERC20} <span class="keyword">from</span> <span class="string">"@openzeppelin/contracts/token/ERC20/ERC20.sol"</span>;
<span class="keyword">import</span> {Ownable} <span class="keyword">from</span> <span class="string">"@openzeppelin/contracts/access/Ownable.sol"</span>;

<span class="keyword">contract</span> <span class="type">BagelToken</span> <span class="keyword">is</span> ERC20, Ownable {
    <span class="comment">// Constructor sets token name and symbol</span>
    <span class="keyword">constructor</span>() ERC20(<span class="string">"BagelToken"</span>, <span class="string">"BAGEL"</span>) Ownable(msg.sender) {}

    <span class="comment">/**
     * @notice Mints new tokens to a specified address
     * @param to Address to receive tokens
     * @param amount Number of tokens to mint
     * @dev Only the contract owner can call this function
     */</span>
    <span class="keyword">function</span> <span class="function">mint</span>(<span class="type">address</span> to, <span class="type">uint256</span> amount) <span class="keyword">external</span> onlyOwner {
        _mint(to, amount);
    }
}</pre>
                </div>

                <h4>Key Features:</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>ERC20 Standard:</strong> Fully compliant with ERC20 token standard</li>
                    <li><strong>Ownable:</strong> Only contract deployer can mint tokens</li>
                    <li><strong>Simple & Secure:</strong> Minimal code reduces attack surface</li>
                </ul>
            </div>

            <div id="merkle" class="tab-content">
                <h3>üå≥ MerkelAirdrop Contract</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>The main airdrop contract that verifies Merkle proofs and EIP-712 signatures to distribute tokens securely.</p>
                </div>

                <h4>Contract Architecture:</h4>
                <div class="diagram-container">
                    <svg width="700" height="400" viewBox="0 0 700 400">
                        <rect x="50" y="20" width="600" height="360" fill="#f5f5f5" stroke="#667eea" stroke-width="2" rx="10"/>
                        <text x="350" y="50" text-anchor="middle" font-weight="bold" font-size="16" fill="#667eea">MerkelAirdrop Contract</text>
                        
                        <!-- State Variables -->
                        <rect x="80" y="70" width="250" height="120" fill="#e3f2fd" rx="5"/>
                        <text x="205" y="90" text-anchor="middle" font-weight="bold" fill="#2196f3">State Variables</text>
                        <text x="90" y="110" font-size="10">‚Ä¢ i_merkleRoot (immutable)</text>
                        <text x="90" y="125" font-size="10">‚Ä¢ i_airdropToken (immutable)</text>
                        <text x="90" y="140" font-size="10">‚Ä¢ s_hasClaimed (mapping)</text>
                        <text x="90" y="155" font-size="10">‚Ä¢ claimers (array)</text>
                        
                        <!-- Events -->
                        <rect x="370" y="70" width="250" height="120" fill="#fff3e0" rx="5"/>
                        <text x="495" y="90" text-anchor="middle" font-weight="bold" fill="#ff9800">Events</text>
                        <text x="380" y="110" font-size="10">‚Ä¢ AirdropClaimed(address, uint256)</text>
                        
                        <!-- Errors -->
                        <rect x="80" y="210" width="250" height="80" fill="#f3e5f5" rx="5"/>
                        <text x="205" y="230" text-anchor="middle" font-weight="bold" fill="#9c27b0">Custom Errors</text>
                        <text x="90" y="250" font-size="10">‚Ä¢ MerkelAirdrop__InvalidProof</text>
                        <text x="90" y="265" font-size="10">‚Ä¢ MerkelAirdrop__AlreadyClaimed</text>
                        <text x="90" y="280" font-size="10">‚Ä¢ MerkelAirdrop__InvalidSignature</text>
                        
                        <!-- Functions -->
                        <rect x="370" y="210" width="250" height="150" fill="#e8f5e9" rx="5"/>
                        <text x="495" y="230" text-anchor="middle" font-weight="bold" fill="#4caf50">Functions</text>
                        <text x="380" y="250" font-size="10">‚Ä¢ claim() - Main claim function</text>
                        <text x="380" y="265" font-size="10">‚Ä¢ getMessageHash() - EIP-712 hash</text>
                        <text x="380" y="280" font-size="10">‚Ä¢ getMerkleRoot() - View root</text>
                        <text x="380" y="295" font-size="10">‚Ä¢ getAirdropToken() - View token</text>
                        <text x="380" y="310" font-size="10">‚Ä¢ _isValidSignature() - Internal</text>
                        <text x="380" y="325" font-size="10">‚Ä¢ _hashTypedDataV4() - EIP712</text>
                        <text x="380" y="340" font-size="10">‚Ä¢ MerkleProof.verify() - OZ lib</text>
                        <text x="380" y="355" font-size="10">‚Ä¢ ECDSA.tryRecover() - OZ lib</text>
                    </svg>
                </div>

                <h4>Claim Function Flow:</h4>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <strong>1. Check Already Claimed</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Revert if address already claimed</p>
                    </div>
                    <div class="workflow-step">
                        <strong>2. Verify Signature</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Check EIP-712 signature validity</p>
                    </div>
                    <div class="workflow-step">
                        <strong>3. Create Leaf Hash</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Hash (account, amount) with double hashing</p>
                    </div>
                    <div class="workflow-step">
                        <strong>4. Verify Merkle Proof</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Check proof against root</p>
                    </div>
                    <div class="workflow-step">
                        <strong>5. Mark Claimed</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Set s_hasClaimed[account] = true</p>
                    </div>
                    <div class="workflow-step">
                        <strong>6. Transfer Tokens</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Send tokens to claimer</p>
                    </div>
                </div>

                <h4>Key Code Sections:</h4>
                
                <h5>1. Constructor & State:</h5>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment">// Immutable state variables (gas efficient)</span>
<span class="type">bytes32</span> <span class="keyword">private immutable</span> i_merkleRoot;
<span class="type">IERC20</span> <span class="keyword">private immutable</span> i_airdropToken;
<span class="keyword">mapping</span>(<span class="type">address</span> claimerAddress => <span class="type">bool</span> claimed) <span class="keyword">private</span> s_hasClaimed;

<span class="comment">// EIP-712 type hash for claim signature</span>
<span class="type">bytes32</span> <span class="keyword">private constant</span> AIRDROP_CLAIM_TYPEHASH = 
    <span class="function">keccak256</span>(<span class="string">"AirdropClaim(address account,uint256 amount)"</span>);

<span class="keyword">constructor</span>(<span class="type">bytes32</span> _merkleRoot, <span class="type">IERC20</span> _airdropToken) EIP712(<span class="string">"MerkelAirdrop"</span>, <span class="string">"1"</span>) {
    i_merkleRoot = _merkleRoot;
    i_airdropToken = _airdropToken;
}</pre>
                </div>

                <h5>2. Claim Function:</h5>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">function</span> <span class="function">claim</span>(
    <span class="type">address</span> _account,
    <span class="type">uint256</span> _amount,
    <span class="type">bytes32[] calldata</span> _merkleProof,  <span class="comment">// calldata for gas savings</span>
    <span class="type">uint8</span> _v,
    <span class="type">bytes32</span> _r,
    <span class="type">bytes32</span> _s
) <span class="keyword">external</span> {
    <span class="comment">// Step 1: Check if already claimed</span>
    <span class="keyword">if</span> (s_hasClaimed[_account]) {
        <span class="keyword">revert</span> MerkelAirdrop__AlreadyClaimed();
    }

    <span class="comment">// Step 2: Verify signature</span>
    <span class="keyword">if</span> (!_isValidSignature(_account, <span class="function">getMessageHash</span>(_account, _amount), _v, _r, _s)) {
        <span class="keyword">revert</span> MerkelAirdrop__InvalidSignature();
    }

    <span class="comment">// Step 3: Create Merkle leaf (double hashing)</span>
    <span class="type">bytes32</span> leaf = <span class="function">keccak256</span>(<span class="function">bytes.concat</span>(
        <span class="function">keccak256</span>(<span class="function">abi.encode</span>(_account, _amount))
    ));

    <span class="comment">// Step 4: Verify Merkle proof</span>
    <span class="keyword">if</span> (!<span class="function">MerkleProof.verify</span>(_merkleProof, i_merkleRoot, leaf)) {
        <span class="keyword">revert</span> MerkelAirdrop__InvalidProof();
    }

    <span class="comment">// Step 5: Mark as claimed</span>
    s_hasClaimed[_account] = <span class="keyword">true</span>;

    <span class="comment">// Step 6: Emit event and transfer</span>
    <span class="function">emit AirdropClaimed</span>(_account, _amount);
    i_airdropToken.<span class="function">safeTransfer</span>(_account, _amount);
}</pre>
                </div>

                <h5>3. EIP-712 Message Hash:</h5>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">function</span> <span class="function">getMessageHash</span>(<span class="type">address</span> _account, <span class="type">uint256</span> _amount) 
    <span class="keyword">public</span> <span class="keyword">view</span> <span class="keyword">returns</span> (<span class="type">bytes32</span>) 
{
    <span class="comment">// Creates EIP-712 compliant typed data hash</span>
    <span class="keyword">return</span> <span class="function">_hashTypedDataV4</span>(
        <span class="function">keccak256</span>(<span class="function">abi.encode</span>(
            AIRDROP_CLAIM_TYPEHASH,
            <span class="type">AirdropClaim</span>({account: _account, amount: _amount})
        ))
    );
}</pre>
                </div>

                <div class="success-card">
                    <h4>‚úÖ Security Features</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Double Hashing:</strong> Prevents second-preimage attacks</li>
                        <li><strong>Signature Verification:</strong> Ensures user authorization</li>
                        <li><strong>Merkle Proof:</strong> Verifies whitelist membership</li>
                        <li><strong>Claim Tracking:</strong> Prevents double claiming</li>
                        <li><strong>Safe Transfer:</strong> Uses OpenZeppelin's SafeERC20</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Section 4: Scripts -->
        <div class="section" id="scripts">
            <h2>üîß Deployment & Utility Scripts</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('deploy')">Deploy</button>
                <button class="tab" onclick="showTab('generate')">Generate Input</button>
                <button class="tab" onclick="showTab('makemerkle')">Make Merkle</button>
                <button class="tab" onclick="showTab('interact')">Interact</button>
            </div>

            <div id="deploy" class="tab-content active">
                <h3>üöÄ DeployMerkelAidrop.s.sol</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>Deploys both BagelToken and MerkelAirdrop contracts, then funds the airdrop with tokens.</p>
                </div>

                <h4>Deployment Flow:</h4>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <strong>1. Deploy BagelToken</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Create ERC20 token contract</p>
                    </div>
                    <div class="workflow-step">
                        <strong>2. Deploy MerkelAirdrop</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Pass Merkle root and token address</p>
                    </div>
                    <div class="workflow-step">
                        <strong>3. Mint Tokens</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Mint total airdrop amount to deployer</p>
                    </div>
                    <div class="workflow-step">
                        <strong>4. Fund Airdrop</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Transfer tokens to airdrop contract</p>
                    </div>
                </div>

                <h4>Complete Code:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">contract</span> <span class="type">DeployMerkelAirdrop</span> <span class="keyword">is</span> Script {
    <span class="comment">// Merkle root from MakeMerkel output</span>
    <span class="type">bytes32</span> <span class="keyword">private</span> s_merkleRoot = 
        0xaa5d581231e596618465a56aa0f5870ba6e20785fe436d5bfb82b08662ccc7c4;
    
    <span class="comment">// Total tokens: 25 tokens √ó 4 addresses = 100 tokens</span>
    <span class="type">uint256</span> <span class="keyword">private</span> s_amountToMint = (25 * 1e18) * 4;

    <span class="keyword">function</span> <span class="function">deployMerkelAirdrop</span>() 
        <span class="keyword">public</span> <span class="keyword">returns</span> (MerkelAirdrop, BagelToken) 
    {
        vm.<span class="function">startBroadcast</span>();
        
        <span class="comment">// Step 1: Deploy BagelToken</span>
        BagelToken bagelToken = <span class="keyword">new</span> BagelToken();
        
        <span class="comment">// Step 2: Deploy MerkelAirdrop with Merkle root and token</span>
        MerkelAirdrop merkelAirdrop = <span class="keyword">new</span> MerkelAirdrop(
            s_merkleRoot, 
            IERC20(<span class="function">address</span>(bagelToken))
        );
        
        <span class="comment">// Step 3: Mint tokens to deployer (owner)</span>
        bagelToken.<span class="function">mint</span>(bagelToken.<span class="function">owner</span>(), s_amountToMint);
        
        <span class="comment">// Step 4: Transfer tokens to airdrop contract</span>
        bagelToken.<span class="function">transfer</span>(<span class="function">address</span>(merkelAirdrop), s_amountToMint);
        
        vm.<span class="function">stopBroadcast</span>();
        
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"MerkelAirdrop deployed to: "</span>, <span class="function">address</span>(merkelAirdrop));
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"BagelToken deployed to: "</span>, <span class="function">address</span>(bagelToken));
        
        <span class="keyword">return</span> (merkelAirdrop, bagelToken);
    }

    <span class="keyword">function</span> <span class="function">run</span>() <span class="keyword">external</span> <span class="keyword">returns</span> (MerkelAirdrop, BagelToken) {
        <span class="keyword">return</span> <span class="function">deployMerkelAirdrop</span>();
    }
}</pre>
                </div>

                <h4>Usage:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment"># Deploy to local Anvil</span>
forge script script/DeployMerkelAidrop.s.sol --rpc-url http://127.0.0.1:8545 --broadcast

<span class="comment"># Or use Makefile shortcut</span>
make deploy</pre>
                </div>
            </div>

            <div id="generate" class="tab-content">
                <h3>üìù GenerateInput.s.sol</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>Generates the input.json file containing whitelisted addresses and their token allocations for the Merkle tree.</p>
                </div>

                <h4>Input Structure:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre>{
  <span class="string">"types"</span>: [<span class="string">"address"</span>, <span class="string">"uint"</span>],    <span class="comment">// Data types for Merkle leaves</span>
  <span class="string">"count"</span>: 4,                        <span class="comment">// Number of whitelist entries</span>
  <span class="string">"values"</span>: {
    <span class="string">"0"</span>: {<span class="string">"0"</span>: <span class="string">"0x6CA6..."</span>, <span class="string">"1"</span>: <span class="string">"25000000000000000000"</span>},
    <span class="string">"1"</span>: {<span class="string">"0"</span>: <span class="string">"0xf39F..."</span>, <span class="string">"1"</span>: <span class="string">"25000000000000000000"</span>},
    <span class="string">"2"</span>: {<span class="string">"0"</span>: <span class="string">"0x2ea3..."</span>, <span class="string">"1"</span>: <span class="string">"25000000000000000000"</span>},
    <span class="string">"3"</span>: {<span class="string">"0"</span>: <span class="string">"0xf6dB..."</span>, <span class="string">"1"</span>: <span class="string">"25000000000000000000"</span>}
  }
}</pre>
                </div>

                <h4>Complete Code:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">contract</span> <span class="type">GenerateInput</span> <span class="keyword">is</span> Script {
    <span class="comment">// Amount per whitelisted address (25 tokens with 18 decimals)</span>
    <span class="type">uint256</span> <span class="keyword">private constant</span> AMOUNT = 25 * 1e18;

    <span class="comment">// JSON schema types: [address, uint]</span>
    <span class="type">string</span>[] types = <span class="keyword">new</span> <span class="type">string</span>[](2);

    <span class="comment">// Whitelisted addresses</span>
    <span class="type">string</span>[] whitelist = <span class="keyword">new</span> <span class="type">string</span>[](4);

    <span class="keyword">function</span> <span class="function">run</span>() <span class="keyword">public</span> {
        <span class="comment">// Define data types</span>
        types[0] = <span class="string">"address"</span>;
        types[1] = <span class="string">"uint"</span>;

        <span class="comment">// Set whitelist addresses</span>
        whitelist[0] = <span class="string">"0x6CA6d1e2D5347Bfab1d91e883F1915560e09129D"</span>;
        whitelist[1] = <span class="string">"0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"</span>;
        whitelist[2] = <span class="string">"0x2ea3970Ed82D5b30be821FAAD4a731D35964F7dd"</span>;
        whitelist[3] = <span class="string">"0xf6dBa02C01AF48Cf926579F77C9f874Ca640D91D"</span>;

        <span class="comment">// Generate JSON string</span>
        <span class="type">string</span> memory input = _createJSON();

        <span class="comment">// Write to file</span>
        vm.<span class="function">writeFile</span>(
            <span class="function">string.concat</span>(vm.<span class="function">projectRoot</span>(), <span class="string">"/script/target/input.json"</span>), 
            input
        );

        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"DONE: The output is found at /script/target/input.json"</span>);
    }

    <span class="keyword">function</span> <span class="function">_createJSON</span>() <span class="keyword">internal view returns</span> (<span class="type">string</span> memory) {
        <span class="type">string</span> memory json = <span class="function">string.concat</span>(
            '{ "types": ["address", "uint"], "count":', 
            vm.<span class="function">toString</span>(whitelist.length), 
            ',"values": {'
        );

        <span class="comment">// Build JSON for each whitelist entry</span>
        <span class="keyword">for</span> (<span class="type">uint256</span> i = 0; i < whitelist.length; i++) {
            <span class="comment">// ... JSON construction logic</span>
        }

        <span class="keyword">return</span> json;
    }
}</pre>
                </div>

                <h4>Usage:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre>forge script script/GenerateInput.s.sol</pre>
                </div>
            </div>

            <div id="makemerkle" class="tab-content">
                <h3>üå≥ MakeMerkel.s.sol</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>Reads input.json, generates Merkle tree, and creates output.json with Merkle proofs for each whitelisted address.</p>
                </div>

                <h4>Processing Flow:</h4>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <strong>1. Read input.json</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Parse whitelist data</p>
                    </div>
                    <div class="workflow-step">
                        <strong>2. Create Leaves</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Hash each (address, amount) pair</p>
                    </div>
                    <div class="workflow-step">
                        <strong>3. Build Tree</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Generate Merkle root</p>
                    </div>
                    <div class="workflow-step">
                        <strong>4. Generate Proofs</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Create proof for each leaf</p>
                    </div>
                    <div class="workflow-step">
                        <strong>5. Write output.json</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Save proofs and root</p>
                    </div>
                </div>

                <h4>Key Code Section:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">function</span> <span class="function">run</span>() <span class="keyword">public</span> {
    <span class="comment">// Read input.json</span>
    <span class="type">string</span> memory elements = vm.<span class="function">readFile</span>(
        <span class="function">string.concat</span>(vm.<span class="function">projectRoot</span>(), inputPath)
    );

    <span class="comment">// Extract types and count</span>
    <span class="type">string</span>[] memory types = elements.<span class="function">readStringArray</span>(<span class="string">".types"</span>);
    <span class="type">uint256</span> count = elements.<span class="function">readUint</span>(<span class="string">".count"</span>);

    <span class="comment">// Create Merkle leaves</span>
    <span class="keyword">for</span> (<span class="type">uint256</span> i = 0; i < count; ++i) {
        <span class="comment">// Read address and amount from JSON</span>
        <span class="type">address</span> value = elements.<span class="function">readAddress</span>(
            <span class="function">getValuesByIndex</span>(i, 0)
        );
        <span class="type">uint256</span> amount = vm.<span class="function">parseUint</span>(
            elements.<span class="function">readString</span>(<span class="function">getValuesByIndex</span>(i, 1))
        );

        <span class="comment">// Create leaf hash (same logic as contract)</span>
        <span class="type">bytes32</span>[] memory data = <span class="keyword">new</span> <span class="type">bytes32</span>[](2);
        data[0] = <span class="function">bytes32</span>(<span class="function">uint256</span>(<span class="function">uint160</span>(value)));
        data[1] = <span class="function">bytes32</span>(amount);
        
        leafs[i] = <span class="function">keccak256</span>(<span class="function">bytes.concat</span>(
            <span class="function">keccak256</span>(<span class="function">ltrim64</span>(<span class="function">abi.encode</span>(data)))
        ));
    }

    <span class="comment">// Generate proofs and create output</span>
    <span class="keyword">for</span> (<span class="type">uint256</span> i = 0; i < count; ++i) {
        <span class="type">string</span> memory proof = <span class="function">bytes32ArrayToString</span>(
            m.<span class="function">getProof</span>(leafs, i)
        );
        <span class="type">string</span> memory root = vm.<span class="function">toString</span>(m.<span class="function">getRoot</span>(leafs));
        <span class="type">string</span> memory leaf = vm.<span class="function">toString</span>(leafs[i]);
        
        outputs[i] = <span class="function">generateJsonEntries</span>(inputs[i], proof, root, leaf);
    }

    <span class="comment">// Write output.json</span>
    vm.<span class="function">writeFile</span>(
        <span class="function">string.concat</span>(vm.<span class="function">projectRoot</span>(), outputPath), 
        output
    );
}</pre>
                </div>

                <div class="info-card">
                    <h4>üìä Output Structure</h4>
                    <p>The output.json contains for each address:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><code>inputs</code>: [address, amount]</li>
                        <li><code>proof</code>: Merkle proof array</li>
                        <li><code>root</code>: Merkle root hash</li>
                        <li><code>leaf</code>: Leaf hash</li>
                    </ul>
                </div>

                <h4>Usage:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre>forge script script/MakeMerkel.s.sol</pre>
                </div>
            </div>

            <div id="interact" class="tab-content">
                <h3>üí∏ Interact.s.sol</h3>
                
                <div class="concept-box">
                    <h4>Purpose</h4>
                    <p>Interactive script to claim airdrop tokens using Merkle proof and signature verification.</p>
                </div>

                <h4>Claim Process:</h4>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <strong>1. Find Deployment</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Get most recent contract address</p>
                    </div>
                    <div class="workflow-step">
                        <strong>2. Split Signature</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Extract v, r, s components</p>
                    </div>
                    <div class="workflow-step">
                        <strong>3. Call Claim</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Execute claim on contract</p>
                    </div>
                    <div class="workflow-step">
                        <strong>4. Verify Success</strong>
                        <p style="font-size: 12px; margin-top: 5px;">Check token balance</p>
                    </div>
                </div>

                <h4>Key Code Section:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="keyword">contract</span> <span class="type">ClaimAirdrop</span> <span class="keyword">is</span> Script {
    <span class="comment">// Claiming address and amount</span>
    <span class="type">address</span> <span class="keyword">public</span> CLAIMING_ADDRESS = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266;
    <span class="type">uint256</span> <span class="keyword">public</span> CLAIMING_AMOUNT = 25 * 1e18;

    <span class="comment">// Merkle proof from output.json</span>
    <span class="type">bytes32</span>[] MERKLE_PROOF = [
        0xd1445c931158119b00449ffcac3c947d028c0c359c34a6646d95962b3b55c6ad,
        0xe5ebd1e1b5a5478a944ecab36a9a954ac3b6b8216875f6524caa7a1d87096576
    ];

    <span class="comment">// Pre-signed signature (65 bytes: r + s + v)</span>
    <span class="type">bytes</span> <span class="keyword">private</span> SIGNATURE = hex"f5a9bd6cd964ddd38d1f86c4c2352c87563f75b22120c47b1336c98542956e03630e5a6181ba9b5fb7c203b543f1c9dbe0a6169e93c06977881c675c3b58aa071c";

    <span class="keyword">function</span> <span class="function">run</span>() <span class="keyword">external</span> {
        <span class="comment">// Get most recent deployment</span>
        <span class="type">address</span> mostRecentlyDeployed = DevOpsTools.<span class="function">get_most_recent_deployment</span>(
            <span class="string">"MerkelAirdrop"</span>, 
            block.chainid
        );
        <span class="function">claimAirdrop</span>(mostRecentlyDeployed);
    }

    <span class="keyword">function</span> <span class="function">claimAirdrop</span>(<span class="type">address</span> _merkelAirdrop) <span class="keyword">public</span> {
        vm.<span class="function">startBroadcast</span>();

        <span class="comment">// Split signature into v, r, s</span>
        (<span class="type">uint8</span> v, <span class="type">bytes32</span> r, <span class="type">bytes32</span> s) = <span class="function">splitSignature</span>(SIGNATURE);

        <span class="comment">// Log claim details</span>
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Claiming address:"</span>, CLAIMING_ADDRESS);
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Claiming amount:"</span>, CLAIMING_AMOUNT);
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"v:"</span>, v);

        <span class="comment">// Execute claim</span>
        MerkelAirdrop(_merkelAirdrop).<span class="function">claim</span>(
            CLAIMING_ADDRESS, 
            CLAIMING_AMOUNT, 
            MERKLE_PROOF, 
            v, r, s
        );

        vm.<span class="function">stopBroadcast</span>();
    }

    <span class="keyword">function</span> <span class="function">splitSignature</span>(<span class="type">bytes</span> memory sig) 
        <span class="keyword">public pure returns</span> (<span class="type">uint8</span> v, <span class="type">bytes32</span> r, <span class="type">bytes32</span> s) 
    {
        <span class="keyword">if</span> (sig.length != 65) {
            <span class="keyword">revert</span> InteractScript__InvalidSignatureLength();
        }

        <span class="comment">// Extract v, r, s using assembly</span>
        <span class="keyword">assembly</span> {
            r := mload(<span class="function">add</span>(sig, 32))   <span class="comment">// First 32 bytes</span>
            s := mload(<span class="function">add</span>(sig, 64))   <span class="comment">// Next 32 bytes</span>
            v := byte(0, mload(<span class="function">add</span>(sig, 96)))  <span class="comment">// Last byte</span>
        }
    }
}</pre>
                </div>

                <h4>Usage:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><span class="comment"># Claim airdrop</span>
forge script script/Interact.s.sol --rpc-url http://127.0.0.1:8545 --broadcast

<span class="comment"># Or use Makefile</span>
make claim</pre>
                </div>
            </div>
        </div>

        <!-- Section 5: Tests -->
        <div class="section" id="tests">
            <h2>üß™ Test Suite</h2>
            
            <h3>MerkelAirdrop.t.sol</h3>
            
            <div class="concept-box">
                <h4>Test Purpose</h4>
                <p>Comprehensive test suite that verifies the claiming functionality works correctly with Merkle proofs and signature verification.</p>
            </div>

            <h4>Test Structure:</h4>
            <div class="diagram-container">
                <svg width="700" height="300" viewBox="0 0 700 300">
                    <rect x="50" y="50" width="600" height="200" fill="#f5f5f5" stroke="#667eea" stroke-width="2" rx="10"/>
                    <text x="350" y="80" text-anchor="middle" font-weight="bold" font-size="16" fill="#667eea">MerkelAirdropTest Contract</text>
                    
                    <rect x="80" y="100" width="250" height="120" fill="#e3f2fd" rx="5"/>
                    <text x="205" y="120" text-anchor="middle" font-weight="bold" fill="#2196f3">Test Constants</text>
                    <text x="90" y="140" font-size="10">‚Ä¢ MERKLE_ROOT</text>
                    <text x="90" y="155" font-size="10">‚Ä¢ MERKLE_PROOF</text>
                    <text x="90" y="170" font-size="10">‚Ä¢ AMOUNT_TO_CLAIM</text>
                    <text x="90" y="185" font-size="10">‚Ä¢ AMOUNT_TO_MINT</text>
                    
                    <rect x="370" y="100" width="250" height="120" fill="#e8f5e9" rx="5"/>
                    <text x="495" y="120" text-anchor="middle" font-weight="bold" fill="#4caf50">Test Functions</text>
                    <text x="380" y="140" font-size="10">‚Ä¢ setUp() - Deploy contracts</text>
                    <text x="380" y="155" font-size="10">‚Ä¢ testUserCanClaim() - Main test</text>
                    <text x="380" y="170" font-size="10">‚Ä¢ Uses vm.sign() for signature</text>
                    <text x="380" y="185" font-size="10">‚Ä¢ Uses vm.prank() for gas payer</text>
                </svg>
            </div>

            <h4>Complete Test Code:</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><span class="keyword">contract</span> <span class="type">MerkelAirdropTest</span> <span class="keyword">is</span> Test {
    MerkelAirdrop <span class="keyword">public</span> merkelAirdrop;
    BagelToken <span class="keyword">public</span> bagelToken;

    <span class="comment">// Test constants from MakeMerkel output</span>
    <span class="type">bytes32</span> <span class="keyword">public constant</span> MERKLE_ROOT = 
        0xaa5d581231e596618465a56aa0f5870ba6e20785fe436d5bfb82b08662ccc7c4;
    
    <span class="type">bytes32</span>[] <span class="keyword">public</span> MERKLE_PROOF = [
        0x0fd7c981d39bece61f7499702bf59b3114a90e66b51ba2c53abdf7b62986c00a,
        0xe5ebd1e1b5a5478a944ecab36a9a954ac3b6b8216875f6524caa7a1d87096576
    ];
    
    <span class="type">uint256</span> <span class="keyword">public constant</span> AMOUNT_TO_CLAIM = 25 * 1e18;

    <span class="type">address</span> user;
    <span class="type">uint256</span> userPrivateKey;
    <span class="type">address</span> gasPayer;

    <span class="keyword">function</span> <span class="function">setUp</span>() <span class="keyword">public</span> {
        <span class="comment">// Deploy contracts using deployment script</span>
        DeployMerkelAirdrop deployMerkelAirdrop = <span class="keyword">new</span> DeployMerkelAirdrop();
        (merkelAirdrop, bagelToken) = deployMerkelAirdrop.<span class="function">deployMerkelAirdrop</span>();
        
        <span class="comment">// Create test user and gas payer</span>
        (user, userPrivateKey) = <span class="function">makeAddrAndKey</span>(<span class="string">"user"</span>);
        gasPayer = <span class="function">makeAddr</span>(<span class="string">"gasPayer"</span>);
    }

    <span class="keyword">function</span> <span class="function">testUserCanClaim</span>() <span class="keyword">public</span> {
        <span class="comment">// Get starting balance</span>
        <span class="type">uint256</span> startingBalance = bagelToken.<span class="function">balanceOf</span>(user);
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Starting Balance:"</span>, startingBalance);

        <span class="comment">// Get message hash and sign it</span>
        <span class="type">bytes32</span> digest = merkelAirdrop.<span class="function">getMessageHash</span>(user, AMOUNT_TO_CLAIM);
        (<span class="type">uint8</span> v, <span class="type">bytes32</span> r, <span class="type">bytes32</span> s) = vm.<span class="function">sign</span>(userPrivateKey, digest);

        <span class="comment">// Claim from gasPayer address (gasless claiming)</span>
        vm.<span class="function">prank</span>(gasPayer);
        merkelAirdrop.<span class="function">claim</span>(user, AMOUNT_TO_CLAIM, MERKLE_PROOF, v, r, s);

        <span class="comment">// Verify balance increased</span>
        <span class="type">uint256</span> endingBalance = bagelToken.<span class="function">balanceOf</span>(user);
        <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Ending Balance:"</span>, endingBalance);
        
        <span class="function">assertEq</span>(endingBalance - startingBalance, AMOUNT_TO_CLAIM);
    }
}</pre>
            </div>

            <h4>Running Tests:</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><span class="comment"># Run all tests</span>
forge test

<span class="comment"># Run with gas report</span>
forge test --gas-report

<span class="comment"># Run specific test</span>
forge test --match-test testUserCanClaim -vvvv</pre>
            </div>

            <h4>Test Coverage:</h4>
            <div class="success-card">
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>‚úÖ Valid claim with correct proof and signature</li>
                    <li>‚úÖ Signature verification (user authorization)</li>
                    <li>‚úÖ Merkle proof verification (whitelist check)</li>
                    <li>‚úÖ Gas payer functionality (relayer support)</li>
                    <li>‚úÖ Token transfer verification</li>
                </ul>
            </div>
        </div>

        <!-- Section 6: Complete Workflow -->
        <div class="section" id="workflow">
            <h2>üîÑ Complete Workflow</h2>
            
            <h3>End-to-End Airdrop Process</h3>
            
            <div class="diagram-container">
                <svg width="800" height="600" viewBox="0 0 800 600">
                    <!-- Title -->
                    <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#667eea">Complete Airdrop Workflow</text>
                    
                    <!-- Step 1: Generate Input -->
                    <rect x="50" y="60" width="150" height="80" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="10"/>
                    <text x="125" y="90" text-anchor="middle" font-weight="bold" fill="#2196f3">1. Generate Input</text>
                    <text x="125" y="110" text-anchor="middle" font-size="10">Create whitelist</text>
                    <text x="125" y="125" text-anchor="middle" font-size="10">input.json</text>
                    
                    <!-- Arrow 1 -->
                    <line x1="200" y1="100" x2="250" y2="100" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 2: Make Merkle -->
                    <rect x="250" y="60" width="150" height="80" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="10"/>
                    <text x="325" y="90" text-anchor="middle" font-weight="bold" fill="#ff9800">2. Make Merkle</text>
                    <text x="325" y="110" text-anchor="middle" font-size="10">Generate proofs</text>
                    <text x="325" y="125" text-anchor="middle" font-size="10">output.json</text>
                    
                    <!-- Arrow 2 -->
                    <line x1="400" y1="100" x2="450" y2="100" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 3: Deploy -->
                    <rect x="450" y="60" width="150" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="10"/>
                    <text x="525" y="90" text-anchor="middle" font-weight="bold" fill="#9c27b0">3. Deploy</text>
                    <text x="525" y="110" text-anchor="middle" font-size="10">Deploy contracts</text>
                    <text x="525" y="125" text-anchor="middle" font-size="10">Fund airdrop</text>
                    
                    <!-- Arrow 3 -->
                    <line x1="600" y1="100" x2="650" y2="100" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 4: User Signs -->
                    <rect x="650" y="60" width="120" height="80" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="10"/>
                    <text x="710" y="90" text-anchor="middle" font-weight="bold" fill="#4caf50">4. User Signs</text>
                    <text x="710" y="110" text-anchor="middle" font-size="10">EIP-712</text>
                    <text x="710" y="125" text-anchor="middle" font-size="10">signature</text>
                    
                    <!-- Arrow down -->
                    <line x1="710" y1="140" x2="710" y2="180" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 5: Claim -->
                    <rect x="600" y="180" width="220" height="80" fill="#fce4ec" stroke="#e91e63" stroke-width="2" rx="10"/>
                    <text x="710" y="210" text-anchor="middle" font-weight="bold" fill="#e91e63">5. Claim Airdrop</text>
                    <text x="710" y="230" text-anchor="middle" font-size="10">Submit proof + signature</text>
                    <text x="710" y="245" text-anchor="middle" font-size="10">to contract</text>
                    
                    <!-- Arrow left -->
                    <line x1="600" y1="220" x2="550" y2="220" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 6: Verify -->
                    <rect x="350" y="180" width="200" height="80" fill="#e0f7fa" stroke="#00bcd4" stroke-width="2" rx="10"/>
                    <text x="450" y="210" text-anchor="middle" font-weight="bold" fill="#00bcd4">6. Verify</text>
                    <text x="450" y="230" text-anchor="middle" font-size="10">Merkle proof +</text>
                    <text x="450" y="245" text-anchor="middle" font-size="10">signature</text>
                    
                    <!-- Arrow left -->
                    <line x1="350" y1="220" x2="300" y2="220" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 7: Transfer -->
                    <rect x="100" y="180" width="200" height="80" fill="#fff8e1" stroke="#ffc107" stroke-width="2" rx="10"/>
                    <text x="200" y="210" text-anchor="middle" font-weight="bold" fill="#ffc107">7. Transfer</text>
                    <text x="200" y="230" text-anchor="middle" font-size="10">Send tokens to</text>
                    <text x="200" y="245" text-anchor="middle" font-size="10">user</text>
                    
                    <!-- Arrow down -->
                    <line x1="200" y1="260" x2="200" y2="300" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- Step 8: Complete -->
                    <rect x="100" y="300" width="200" height="60" fill="#4caf50" rx="10"/>
                    <text x="200" y="335" text-anchor="middle" font-weight="bold" fill="white">‚úì Claim Complete!</text>
                    
                    <!-- Legend -->
                    <rect x="50" y="400" width="700" height="180" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="10"/>
                    <text x="400" y="425" text-anchor="middle" font-weight="bold" font-size="14">Quick Reference</text>
                    
                    <text x="70" y="450" font-size="11" font-weight="bold" fill="#667eea">Commands:</text>
                    <text x="70" y="470" font-size="10">‚Ä¢ make anvil - Start local chain</text>
                    <text x="70" y="490" font-size="10">‚Ä¢ make deploy - Deploy contracts</text>
                    <text x="70" y="510" font-size="10">‚Ä¢ make merkle - Generate Merkle data</text>
                    <text x="70" y="530" font-size="10">‚Ä¢ make sign - Generate signature</text>
                    <text x="70" y="550" font-size="10">‚Ä¢ make claim - Claim airdrop</text>
                    
                    <text x="400" y="450" font-size="11" font-weight="bold" fill="#667eea">Key Files:</text>
                    <text x="400" y="470" font-size="10">‚Ä¢ /script/target/input.json - Whitelist data</text>
                    <text x="400" y="490" font-size="10">‚Ä¢ /script/target/output.json - Merkle proofs</text>
                    <text x="400" y="510" font-size="10">‚Ä¢ Makefile - All commands</text>
                    
                    <!-- Arrow marker definition -->
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
                        </marker>
                    </defs>
                </svg>
            </div>

            <h3>Quick Start Commands:</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><span class="comment"># 1. Start local blockchain</span>
make anvil

<span class="comment"># 2. Generate Merkle tree data</span>
make merkle

<span class="comment"># 3. Deploy contracts</span>
make deploy

<span class="comment"># 4. Generate signature for claim</span>
make sign

<span class="comment"># 5. Claim airdrop</span>
make claim

<span class="comment"># 6. Check balance</span>
make balance

<span class="comment"># 7. Run tests</span>
make test</pre>
            </div>

            <h3>Interactive Demo:</h3>
            <div class="interactive-demo">
                <div class="demo-controls">
                    <button class="demo-btn" onclick="runDemo('generate')">Generate Input</button>
                    <button class="demo-btn" onclick="runDemo('merkle')">Make Merkle</button>
                    <button class="demo-btn" onclick="runDemo('deploy')">Deploy</button>
                    <button class="demo-btn" onclick="runDemo('claim')">Claim</button>
                </div>
                <div class="demo-output" id="demoOutput">
                    <p style="color: #666; padding: 10px;">Click a button above to see what happens...</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="section" style="text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <h3 style="color: white; margin-bottom: 10px;">ü•Ø Merkle Airdrop & Signature Verification</h3>
            <p>A secure, gas-efficient token distribution system</p>
            <p style="margin-top: 20px; font-size: 14px;">Built with Foundry ‚Ä¢ OpenZeppelin ‚Ä¢ EIP-712 ‚Ä¢ Merkle Trees</p>
            <p style="margin-top: 10px; font-size: 12px; opacity: 0.8;">By moayaan.eth</p>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('pre').textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            });
        }

        function runDemo(action) {
            const output = document.getElementById('demoOutput');
            let message = '';
            
            switch(action) {
                case 'generate':
                    message = `
<strong>üìù Generating Input...</strong>
<br>
‚úì Created input.json with 4 whitelisted addresses
<br>
‚úì Each address: 25 BAGEL tokens
<br>
‚úì Total: 100 tokens
<br>
<br>
<em>File saved to: /script/target/input.json</em>
                    `;
                    break;
                case 'merkle':
                    message = `
<strong>üå≥ Building Merkle Tree...</strong>
<br>
‚úì Created 4 leaf hashes from (address, amount) pairs
<br>
‚úì Generated Merkle root: 0xaa5d581231e596618...7c4
<br>
‚úì Created Merkle proofs for each address
<br>
<br>
<em>File saved to: /script/target/output.json</em>
                    `;
                    break;
                case 'deploy':
                    message = `
<strong>üöÄ Deploying Contracts...</strong>
<br>
‚úì Deployed BagelToken to: 0x5FbDB2315678afecb367f032d93F642f64180aa3
<br>
‚úì Deployed MerkelAirdrop to: 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
<br>
‚úì Minted 100 tokens to deployer
<br>
‚úì Transferred 100 tokens to airdrop contract
<br>
<br>
<em>Deployment complete! Ready for claims.</em>
                    `;
                    break;
                case 'claim':
                    message = `
<strong>üí∏ Claiming Airdrop...</strong>
<br>
‚úì Claiming address: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
<br>
‚úì Amount: 25 * 10^18 BAGEL tokens
<br>
‚úì Signature verified (v=28)
<br>
‚úì Merkle proof verified
<br>
‚úì Transfer complete
<br>
<br>
<em>‚úÖ Claim successful! User now has 25 BAGEL tokens.</em>
                    `;
                    break;
            }
            
            output.innerHTML = message;
        }

        // Smooth scroll for navigation
        document.querySelectorAll('.nav-menu a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            });
        });
    </script>
</body>
</html>
